## 目标

* 管理后台所有接口统一直连 Supabase 数据库，移除“本地开发存储降级（devStore）”逻辑。

* 保留严格的鉴权与错误返回（401/403/5xx），不再回退到本地 JSON。

## 影响范围

* 文件：`api/routes/admin.ts`

* 路由（全部清理降级分支，仅保留 Supabase 直连）：

  * 分类：`GET/POST/PUT/DELETE /api/admin/categories`

  * 技能：`GET/POST/PUT/DELETE /api/admin/skills` 与 `GET /api/admin/skills/:id`

  * 用户：`GET/POST/PUT/DELETE /api/admin/users`

  * 管理员用户：`GET/POST/PUT/DELETE /api/admin/admin-users`

  * 友情链接：`GET/POST/PUT/DELETE /api/admin/links`

## 具体调整

* 移除：`import { readCategories, addCategory, ... } from '../utils/devStore.js'` 全部 devStore 引用。

* 删除：所有 `if (/schema cache/i.test(error.message) || error.code === 'PGRST002' || /fetch failed/i.test(error.message))` 分支的降级逻辑。

* 错误处理：

  * 查询/写入失败 → 返回 `500 { message: 'xxx失败', error: error.message }`

  * 认证失败 → `401`；权限不足 → `403`

  * 资源不存在 → `404`

* 响应结构统一：

  * 列表：`{ items, page?, pageSize?, total? }`

  * 详情/新增/更新：`{ item }`

  * 删除：`{ success: true }`

## 安全与配置

* 保留 Supabase 服务端客户端惰性初始化（Service Role Key）：`VITE_SUPABASE_URL`、`SUPABASE_SERVICE_ROLE_KEY` 必须配置。

* 不做本地文件写入／读取（彻底禁用降级）。

## 验证用例

* 分类/技能/用户/管理员/链接全 CRUD：返回 2xx 或明确 4xx/5xx，不出现本地数据。

* 401/403：移除 token 或使用非管理员角色，确认接口拒绝访问。

* 异常场景：故意传无效字段，确认返回 500 与清晰 message。

## 风险与回滚

* 若 Supabase 暂时不可用，管理后台会返回错误而非展示本地数据。

* 如需回退，可在单独分支保留原降级逻辑（本次将完全移除）。

***

确认后我将：

1. 清理 `admin.ts` 中所有 devStore 降级分支与导入；
2. 统一错误与响应结构；
3. 自测所有管理路由并提交到 Git；
4. 部署到 Vercel。

